{"version":3,"sources":["index.tsx"],"names":["Img","props","React","loadState","setLoadState","src","alt","onError","onLoad","style","display","title","backgroundColor","VirtualizedRenderer","numberOfBufferRows","buffer","numberOfThumbnailsPerRow","columns","numberOfThumbnailsPerColumn","rows","numberOfThumbnails","thumbnails","length","numberOfVisibleThumbnails","totalNumberOfRows","Math","ceil","columnWidthPercentage","rowHeightPercentage","totalRowHeightPercentage","bodyHeightRef","document","body","clientHeight","bodyWidthRef","clientWidth","htmlHeightRef","documentElement","htmlWidthRef","scrollXRef","window","scrollX","scrollYRef","scrollY","getNextFirstVisibleRowIndex","scrollProportionY","current","round","firstVisibleThumbnailIndex","setFirstVisibleThumbnailIndex","visibleThumbnails","slice","max","min","debouncedDocumentScrollEventHandler","debounce","_event","maxWait","addEventListener","cancel","removeEventListener","windowLoadEventHandler","debouncedWindowResizeEventHandler","scaleChangeX","scaleChangeY","scroll","height","lineHeight","margin","padding","position","textAlign","top","width","map","visibleThumbnail","index","column","row","floor","description","url","left","createTimestampDescription","timestamp","Date","toLocaleString","createTimestampUrl","from","to","by","transform","n","result","push","range","element","container","querySelector","ReactDOM"],"mappings":"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","file":"static/js/main.f342594e.chunk.js","sourcesContent":["import debounce from 'lodash.debounce'\nimport * as React from 'react'\nimport * as ReactDOM from 'react-dom'\n\nimport './index.css'\n\nconst Img = (\n  props: React.DetailedHTMLProps<\n    React.ImgHTMLAttributes<HTMLImageElement>,\n    HTMLImageElement\n  >,\n) => {\n  const [loadState, setLoadState] = React.useState<\n    'initial' | 'loading' | 'success' | 'failure'\n  >('initial')\n\n  React.useLayoutEffect(() => {\n    setLoadState('loading')\n  }, [props.src])\n\n  return (\n    <React.Fragment>\n      <img\n        alt={props.alt}\n        onError={() => setLoadState('failure')}\n        onLoad={() => setLoadState('success')}\n        src={props.src}\n        style={\n          loadState === 'success'\n            ? props.style\n            : {\n                display: 'none',\n              }\n        }\n        title={props.title}\n      />\n      <img\n        alt={''}\n        style={\n          loadState === 'success'\n            ? {\n                display: 'none',\n              }\n            : {\n                ...props.style,\n                backgroundColor:\n                  loadState === 'failure'\n                    ? 'red'\n                    : loadState === 'loading'\n                    ? 'gray'\n                    : 'white',\n              }\n        }\n        title={props.title}\n      />\n    </React.Fragment>\n  )\n}\n\nconst VirtualizedRenderer = (props: {\n  buffer: number\n  columns: number\n  rows: number\n  thumbnails: Array<{\n    description: string\n    index: number\n    timestamp: number\n    url: string\n  }>\n}) => {\n  const {\n    buffer: numberOfBufferRows,\n    columns: numberOfThumbnailsPerRow,\n    rows: numberOfThumbnailsPerColumn,\n    thumbnails: { length: numberOfThumbnails },\n  } = props\n\n  const numberOfVisibleThumbnails =\n    numberOfThumbnailsPerColumn * numberOfThumbnailsPerRow\n\n  const totalNumberOfRows = Math.ceil(\n    numberOfThumbnails / numberOfThumbnailsPerRow,\n  )\n\n  const columnWidthPercentage =\n    (numberOfThumbnailsPerColumn / numberOfVisibleThumbnails) * 100\n\n  const rowHeightPercentage =\n    (numberOfThumbnailsPerRow / numberOfVisibleThumbnails) * 100\n\n  const totalRowHeightPercentage = totalNumberOfRows * rowHeightPercentage\n\n  const bodyHeightRef = React.useRef(document.body.clientHeight)\n  const bodyWidthRef = React.useRef(document.body.clientWidth)\n\n  const htmlHeightRef = React.useRef(document.documentElement.clientHeight)\n  const htmlWidthRef = React.useRef(document.documentElement.clientWidth)\n\n  const scrollXRef = React.useRef(window.scrollX)\n  const scrollYRef = React.useRef(window.scrollY)\n\n  const getNextFirstVisibleRowIndex = React.useCallback(() => {\n    const scrollProportionY = scrollYRef.current / bodyHeightRef.current\n\n    const nextFirstVisibleRowIndex = Math.round(\n      scrollProportionY * totalNumberOfRows,\n    )\n\n    const nextFirstVisibleThumbnailIndex =\n      nextFirstVisibleRowIndex * numberOfThumbnailsPerRow\n\n    return nextFirstVisibleThumbnailIndex\n  }, [numberOfThumbnailsPerRow, totalNumberOfRows])\n\n  const [\n    firstVisibleThumbnailIndex,\n    setFirstVisibleThumbnailIndex,\n  ] = React.useState(0)\n\n  const visibleThumbnails = React.useMemo(\n    () =>\n      props.thumbnails.slice(\n        Math.max(\n          0,\n          firstVisibleThumbnailIndex -\n            numberOfBufferRows * numberOfThumbnailsPerRow,\n        ),\n        Math.min(\n          props.thumbnails.length,\n          firstVisibleThumbnailIndex +\n            numberOfVisibleThumbnails +\n            numberOfBufferRows * numberOfThumbnailsPerRow,\n        ),\n      ),\n    [\n      props.thumbnails,\n      firstVisibleThumbnailIndex,\n      numberOfBufferRows,\n      numberOfThumbnailsPerRow,\n      numberOfVisibleThumbnails,\n    ],\n  )\n\n  React.useLayoutEffect(() => {\n    const documentScrollEventHandler = (_event: Event) => {\n      scrollXRef.current = window.scrollX\n      scrollYRef.current = window.scrollY\n\n      setFirstVisibleThumbnailIndex(getNextFirstVisibleRowIndex)\n    }\n\n    const debouncedDocumentScrollEventHandler = debounce(\n      documentScrollEventHandler,\n      50,\n      { maxWait: 500 },\n    )\n\n    document.addEventListener('scroll', debouncedDocumentScrollEventHandler)\n\n    return () => {\n      debouncedDocumentScrollEventHandler.cancel()\n\n      document.removeEventListener(\n        'scroll',\n        debouncedDocumentScrollEventHandler,\n      )\n    }\n  }, [getNextFirstVisibleRowIndex, numberOfThumbnailsPerRow, totalNumberOfRows])\n\n  React.useLayoutEffect(() => {\n    const windowLoadEventHandler = (_event: Event) => {\n      bodyHeightRef.current = document.body.clientHeight\n      bodyWidthRef.current = document.body.clientWidth\n\n      htmlHeightRef.current = document.documentElement.clientHeight\n      htmlWidthRef.current = document.documentElement.clientWidth\n\n      scrollXRef.current = window.scrollX\n      scrollYRef.current = window.scrollY\n\n      setFirstVisibleThumbnailIndex(getNextFirstVisibleRowIndex)\n    }\n\n    window.addEventListener('load', windowLoadEventHandler)\n\n    return () => {\n      window.removeEventListener('load', windowLoadEventHandler)\n    }\n  }, [getNextFirstVisibleRowIndex])\n\n  React.useLayoutEffect(() => {\n    const windowResizeEventHandler = (_event: Event) => {\n      const scaleChangeX =\n        document.documentElement.clientWidth / htmlWidthRef.current\n      const scaleChangeY =\n        document.documentElement.clientHeight / htmlHeightRef.current\n\n      bodyHeightRef.current = document.body.clientHeight\n      bodyWidthRef.current = document.body.clientWidth\n\n      htmlHeightRef.current = document.documentElement.clientHeight\n      htmlWidthRef.current = document.documentElement.clientWidth\n\n      scrollXRef.current = Math.round(scrollXRef.current * scaleChangeX)\n      scrollYRef.current = Math.round(scrollYRef.current * scaleChangeY)\n\n      window.scroll(scrollXRef.current, scrollYRef.current)\n    }\n\n    const debouncedWindowResizeEventHandler = debounce(\n      windowResizeEventHandler,\n      50,\n      { maxWait: 500 },\n    )\n\n    window.addEventListener('resize', debouncedWindowResizeEventHandler)\n\n    return () => {\n      debouncedWindowResizeEventHandler.cancel()\n\n      window.removeEventListener('resize', debouncedWindowResizeEventHandler)\n    }\n  }, [])\n\n  return (\n    <div\n      style={{\n        height: `${totalRowHeightPercentage}vh`,\n        lineHeight: 0,\n        margin: 0,\n        padding: 0,\n      }}\n    >\n      <div\n        style={{\n          position: 'fixed',\n          textAlign: 'center',\n          top: '50%',\n          width: '100%',\n        }}\n      >\n        Loading...\n      </div>\n      {visibleThumbnails.map((visibleThumbnail, index) => {\n        const column = index % numberOfThumbnailsPerRow\n\n        const row = Math.floor(\n          visibleThumbnail.index / numberOfThumbnailsPerColumn,\n        )\n\n        return (\n          <Img\n            alt={visibleThumbnail.description}\n            key={`Row: ${row}, Column: ${column}`}\n            src={visibleThumbnail.url}\n            style={{\n              height: `${rowHeightPercentage}vh`,\n              lineHeight: `${rowHeightPercentage}vh`,\n              width: `${columnWidthPercentage}%`,\n              position: 'absolute',\n              left: `calc(100% * ${column} / ${numberOfThumbnailsPerRow})`,\n              top: `calc(100vh * ${row} / ${numberOfThumbnailsPerColumn})`,\n            }}\n            title={visibleThumbnail.description}\n          />\n        )\n      })}\n    </div>\n  )\n}\n\nconst range = <T extends unknown = number>(\n  from: number,\n  to: number,\n  by: number = 1,\n  transform: (n: number, index: number) => T = (n) => n as T,\n) => {\n  const result: Array<T> = []\n\n  for (let n = from; n <= to; n = n + by) {\n    const index = result.length\n    result.push(transform(n, index))\n  }\n\n  return result\n}\n\nconst createTimestampDescription = (timestamp: number, index: number) =>\n  `Thumbnail for camera image #${index + 1} taken ${new Date(\n    timestamp * 1000,\n  ).toLocaleString()}.`\n\nconst createTimestampUrl = (timestamp: number) =>\n  `https://hiring.verkada.com/thumbs/${timestamp}.jpg`\n\nconst createTimestampThumbnail = (timestamp: number, index: number) => ({\n  description: createTimestampDescription(timestamp, index),\n  index,\n  timestamp,\n  url: createTimestampUrl(timestamp),\n})\n\nconst buffer = 3\n\nconst columns = 3\n\nconst rows = 3\n\nconst firstTimestamp = 1500348260\n\nconst lastTimestamp = 1503031520\n\nconst timestampInterval = 20\n\nconst thumbnails = range(\n  firstTimestamp,\n  lastTimestamp,\n  timestampInterval,\n  createTimestampThumbnail,\n)\n\nconst element = (\n  <React.StrictMode>\n    <VirtualizedRenderer\n      buffer={buffer}\n      columns={columns}\n      rows={rows}\n      thumbnails={thumbnails}\n    />\n  </React.StrictMode>\n)\n\nconst container = document.querySelector('#react-container')\n\nReactDOM.render(element, container)\n"],"sourceRoot":""}